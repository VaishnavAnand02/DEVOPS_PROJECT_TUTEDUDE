<!DOCTYPE html>
<html>
    <head>
        <meta charset="UTF-8" />
        <title>
            Form
        </title>
    </head>
    <body>
        <form id="dataform">
            <label>Name:</label><br />
            <input type="text" name="name" required /><br /><br />

            <label>Email:</label><br />
            <input type="email" name="email" required /><br /><br />

            <label>Message:</label><br />
            <textarea name="message" required></textarea><br /><br />

            <button type="submit">Submit</button>
        </form>

        <div id="errorMessage" style="color: red; margin-top: 10px;"></div>
    </body>
    <script>
        document.getElementById('dataform').addEventListener('submit', async(e)=>{
            e.preventDefault()
            const form = e.target;
            const form_data = new FormData(form)
            const data = Object.fromEntries(form_data.entries())

             try {
                const response = await fetch('/api/submit', {
                method: 'POST',
                headers: {
                'Content-Type': 'application/json',
                },
                body: JSON.stringify(data),
                });

                const result = await response.json();

                if (result.success) {
                window.location.href = '/success'; 
                } else {
                 document.getElementById('errorMessage').textContent = 'Error: ' + result.message;
                }
            } catch (error) {
                document.getElementById('errorMessage').textContent = 'Network error: ' + error.message;
            }
        })
    </script>
</html>